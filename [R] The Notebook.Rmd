---
title: "[R] The Notebook"
author: "*Veneta Baeva*"  
output: github_document
---
![](/Users/venetabaeva/git/repository4/Picture1.jpg)
---

## Libraries

> library load 

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(dplyr)
```
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(dslabs)
```
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(tidyverse)
```
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(rafalib)
```
```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(UsingR)
```
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(ggthemes)
```
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(ggrepel)
```
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(ggplot2)
```
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(gridExtra)
```
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(RColorBrewer)
```








## I.

1.[dataFrame] create

```{r}
dfTest <- data.frame(names=c("A","B","C","D"),
                     num1 = c(1,2,3,4),
                     num2 = c(10,20,30,40),
                     stringsAsFactors = FALSE)
dfTest
```

1.[data] read

```{r}
data(heights)
```

1.[file] read

```{r}
dfPonzo <- read.csv(
  file = ("/Users/venetabaeva/git/repository4/PonzoEyeTrack.csv"),
  header = TRUE,
  sep = ";",
  dec = ".")
```

1.[file] read

```{r}
dfAlc <- read.csv(
                      file = ("/Users/venetabaeva/git/repository4/gapminder.csv"),
                      header = TRUE,
                      sep = ";",
                      dec = ".")

```

###### ^1^ click: [Alcohol Consumption](https://www.kaggle.com/sansuthi/alcohol-consumption)

1.[dataFrame] load

```{r}
data(gapminder)
```

1.[file] view 

```{r}
View(dfAlc)
View(gapminder)
```

1.[file] head 

```{r}
head(dfAlc)
head(gapminder) #library(dslabs)
```

1.[file] check structure

```{r}
str(dfAlc)
```

1.[table] create frequency table for factor

```{r}
tableAlcCountry <- c(dfAlc$abbrv)
table(tableAlcCountry)
```

1.[vector] create 

```{r}
country<- c("Afghanistan","Albania","Algeria","Andorra","Angola", "Antigua and Barbuda")
country
abbrv <- c("AF", "AL", "DZ", "AD", "AO", "AG")
abbrv
aconsum <- c(0, 7, 1, 10, 6, 8)
aconsum
x <- c(60,50 ,40, 30, 20)
x
```

1.[vector] change elements' type 

```{r}
y<- as.character(x) 
y
as.numeric(y)
x<-y
```

1.[vector]check default type 

```{r}
x<-c(1,"test",3)
x
class(x)
```

1.[vector]check default type 

```{r}
x<-c("1","test","3")
x
class(x)
as.numeric(x)
```

###### ^1^ Note: coercion problem -> NAs introduced by coercion 

1.[vector] sort elements' values in increasing order 

```{r}
sort(x) 
```

1. [vector] return/keep index of the elements' values in increasing order

```{r}
index <- order(x)
index
```

1.[vector] sort vector's elements in order, through indexing

```{r}
x[index]
```

1.[vector] check order 

```{r}
order(x)
```

1.[vector] rank; returns the order of each element in an ascending list

```{r}
rank(x)
```

1.{vector} associate 

```{r}
abbrvCountry <- c("AF"="Afghanistan", "AL" = "Albania", "DZ" ="Algeria", "AD" = "Andorra", "AO" = "Angola", "AG"= "Antigua and Barbuda")
abbrvCountry
```

1.[vector] assign name

```{r}
names(abbrvCountry)<-abbrv 
abbrv
abbrvCountry
```

1.[vector] access vector's element's value descreately, through indexing 

```{r}
abbrvCountry[2]
```

1.[vector] access vector's elements' values descreately, through indexing

```{r}
abbrvCountry[c(1,3)]
```

1.[vector] access vector's elements' values interval-ly, through indexing 

```{r}
abbrvCountry[1:2]
```

1.[vector] access vector's elements' values interval-ly, through naming the element  

```{r}
abbrvCountry["AF"]
abbrvCountry[c("AL","DZ")]
```

1.[dataFrame] create data frame

```{r}
dfAbbrvAconsum <- data.frame(country = abbrv, alchoholconsumption = aconsum)
```

1.[file] check class

```{r}
class(dfAlc)
class(dfAlc$aconsum)
```

1.[element] change type of element 

```{r}
class(1)
class(1L)
```

1.[sequence] show

```{r}
seq(1,10)
1:10
```

1.[sequence] generate increasing sequence of numbers with pretermed length

```{r}
seq(1, 10, length.out = 100)
```


1.[sequence] check length

```{r}
length(seq(1,10))
```


1.[dataFrame] check levels of a factor

```{r}
levels(dfAlc$aconsum)
```

1.[dataFrame] check number of levels of a factor

```{r}
nlevels(dfAlc$aconsum)
```

1.[file] check headers

```{r}
head(dfAlc)
```
1.[file] check headers' names

```{r}
names(dfAlc)
```

1.[file] exact name 

```{r}
colnames(dfPonzo)
```

1.[file] rename exact name column

```{r}
colnames(dfPonzo)[colnames(dfPonzo) == 'X.Gaze.x...'] <- 'xGaze'
colnames(dfPonzo)[colnames(dfPonzo) == 'X.Gaze.y...'] <- 'yGaze'
colnames(dfPonzo)[colnames(dfPonzo) == 'X..RespondentNr.'] <- 'respondentNr'
colnames(dfPonzo)[colnames(dfPonzo) == 'X.StimulusNr.'] <- 'stimulusNr'
colnames(dfPonzo)[colnames(dfPonzo) == 'X.timestamp.ms.'] <- 'timeStampsMs'
```

1.[row-column] access value

```{r}
dfPonzo[12,3]
```

1.[column-row] access value

```{r}
dfAlc$country[11]
```


1.[column] access

```{r}
dfAlc["aconsum"]
```

1.[vector]sort in increasing order 

```{r}
sort(dfAlc$aconsum)
```


1.[column] access through vector

```{r}
dfAlc[["aconsum"]]
```


1.[column] access through vector

```{r}
dfAlc$aconsum
```

1.[object] define

```{r}
aconsum <- dfAlc$aconsum
urbanrt <-dfAlc$urbanrt
employrt <- dfAlc$employrt
```

1.[vector] count NAs

```{r}
naS <- is.na(aconsum)
sum(naS)
```

1.[vector] expell NAs

```{r}
mean(aconsum[!naS])
```

1.[vector] point column from data frame to calculate the mean for

```{r}
mean(dfAlc[,2])
```


1.[dataFrame] filter, summarize

```{r}
dfAlc %>%
  filter(region == "EMEA") %>%
  summarize(median = median(aconsum), #call only  functions that return a single value
            minimum = min(aconsum),
            maximum = max(aconsum)) 
```

1.[dataFrame] filter, summarize, access  summarized numeric value

```{r}
dfAlcEMEAMedian<- dfAlc %>%
  filter(region == "EMEA") %>%
  summarize(median = median(aconsum), 
            minimum = min(aconsum),
            maximum = max(aconsum))%>%
  .$median #the dot as a placeholder for the data that is being passed through the pipe
```

###### ^1^ Note: most of the dplyr functions, including summarize, always return data frames; if to be used the result with a function that requires a numeric value,  won't be able to do it
###### ^1^ Note:  .$median is equivalent to dfAlcEMEAMedian$median

1.[object] define length

```{r}
length(aconsum)
```

1.[vector] return number of elements

```{r}
lengthAconsum <- length(dfAlc$aconsum)
lengthAconsum
```

1.[object] check identical

```{r}
identical(urbanrt,employrt)
```

1.[vector] return index of the elements' values in increasing order 

1.1.[vector] sort vector's elements in order, through indexing

```{r}
iOrdDfAconsum<-order(dfAlc$aconsum)
dfAlc$abbrv[iOrdDfAconsum]
```

1.[vector] find max value between elements, through indexing

1.1[object] return index

1.1.1[vector] show value of element, through indexing the object 

```{r}
iMax<-which.max(dfAlc$aconsum)
iMax
dfAlc$abbrv[iMax]
dfAlc$abbrv[which.max(dfAlc$aconsum)]
```

1.[vector] find max value between elements, through indexing

1.1[object] return index

1.1.1[vector] show value of element, through indexing the object 

```{r}
iMin<-which.max(dfAlc$aconsum)
iMin
dfAlc$abbrv[iMin]
dfAlc$abbrv[which.min(dfAlc$aconsum)]
```

1.[vector] order

```{r}
dfAlc$abbrv[order(dfAlc$employrt,decreasing=TRUE)]
```

1.[vector] check range through indexing

1.1.[vector] count the number of elements in the range

```{r}
i <- dfAlc$aconsum  < 5
i
dfAlc$abbrv[i]
sum(i,na.rm =TRUE)
```

1.1.[vector] filter data by sub-setting row

```{r}
dplyr::filter(dfAlc, region=="EMEA")
```

1.[vector] filter

```{r}
emea<- dfAlc$region == "EMEA" 
aconsum <- dfAlc$aconsum <= 5 
i <- aconsum&emea
dfAlc$abbrv[i]
```

1.1.[vector] which indexes of elements  has value TRUE 

```{r}
which(i)
```

1.1.[vector] which value TRUE or FALSE of element 

```{r}
i<-which(dfAlc$abbrv == "BG")
i
aconsum[i]
```

1.1.[vector] match values of elements and return TRUE or FALSE 

```{r}
i <- match(c("BG","IT","ES"),dfAlc$abbrv)
i
dfAlc$abbrv[i]
aconsum[i]
```

1.1.[vector] check whether values of vector in values of vector and return TRUE or FALSE 

```{r}
emea<- dfAlc$region == "EMEA" 
aconsum5 <- dfAlc$aconsum <= 5 
aconsum10 <- dfAlc$aconsum <= 5 
aconsum5&emea %in% aconsum10&emea
```

1.1.[vector] check whether each value of vector in values of the same vector and return TRUE or FALSE 

```{r}
checkAbbrv<- c("GB","BG","MZ") %in% dfAlc$abbrv
```

1.1.[vector] check whether each value of vector in values of the same vector, through indexing and return TRUE or FALSE 

```{r}
checkAbbrv<- c("GB","BG","MZ") %in% dfAlc$abbrv
i <- which(!checkAbbrv%in%dfAlc$abbrv)
i
checkAbbrv[i] 
```

1.1.[dataFrame] mutate data frame

```{r}
dfAlc <- dplyr::mutate(dfAlc,rank=rank(-dfAlc$aconsum))
str(dfAlc)
```
###### ^2^ Note: include a column named rank with the ranks of rate from highest to lowest

1.1.[dataFrame] excluding filter value and create data frame 

```{r}
dfNoEMEA <- data.frame(dplyr::filter(dfAlc,region!="EMEA"))
nrow(dfNoEMEA)
```

1.1.[dataFrame] including filter value and create data frame 

```{r}
dfEMEAAPAC <- data.frame(dplyr::filter(dfAlc,region %in% c("EMEA","APAC")))
nrow(dfEMEAAPAC)
```

1.1.[dataFrame] filter and select only

```{r}
EMEAAPACAconsum10 <- dplyr::filter(dfAlc,region %in% c("EMEA","APAC") & aconsum < 10)
dplyr::select(EMEAAPACAconsum10,country,aconsum,rank)
```

1.1.[dataFrame] select subsetting and filter 

```{r}
newTable <- dplyr::select(dfAlc,country,region,aconsum) 
dplyr::filter(newTable,aconsum <= 10)
str(newTable)
```
1.[dataFrame] pipe select and pipe filter

```{r}
dfAlc %>% dplyr::select(country,region,aconsum)  %>% filter(aconsum <= 10)
```

1.[dataFrame] filter pipe select

```{r}
dplyr::filter(dfAlc, region %in% c("EMEA", "APAC") & aconsum < 10 )%>% dplyr::select(country, aconsum, rank)
```
1.[dataFrame] pipe filter select
```{r}
dfAlc %>% mutate(aconsum, rank) %>% dplyr::filter(region %in% c('EMEA','APAC') & aconsum <10) %>% dplyr::select(country,aconsum,rank)
```

1.[dataFrame]

```{r}
ind <- heights$height > mean(heights$height)#How many individuals in the dataset are above average height?
sum(ind)
ind <- heights$height > mean(heights$height) & (heights$sex =="Female")#How many individuals in the dataset are above average height and are female?
sum(ind)
mean(heights$sex == "Female")# proportion of individuals in the dataset are female
minH<- min(heights$height) 
ind <- match(minH, heights$height)#Use the match() function to determine the index of the first individual with the minimum height.
heights$sex[ind]#Subset the sex column of the dataset by the index in 4b to determine the individual’s sex.
maxH <- max(heights$height)#Write code to create a vector x that includes the integers between the minimum and maximum heights (as numbers).
minH <- min(heights$height)
intgr <- c(minH:maxH)
intgr
sum(!(intgr %in% heights$height))#How many of the integers in x are NOT heights in the dataset?
heights <- mutate(heights, ht_cm = height*2.54)#create a new column of heights in centimeters named ht_cm
head(heights)
heights$ht_cm[18]
mean(heights$ht_cm) 
females <- dplyr::filter(heights, sex == "Female") #females by filtering the heights2 data to contain only female individuals.
head(females)
nrow(females)#How many females are in the heights2 dataset?
mean(females$ht_cm)#What is the mean height of the females in centimeters?
```

3.[if-els] 

```{r}
i <- which.min(dfAlc$aconsum)
if (dfAlc$aconsum[i] < 10){
  print(dfAlc$country[i])
}else{
  print("No coutnry has alcochol rate that low")
}
```

3.[ifelse] if logical is TRUE, then return 1st answer, if FALSE, then 2nd answer

```{r}
minAlc <- which.min(dfAlc$aconsum)
ifelse(minAlc,dfAlc$country,NA)
```

2.[dataFrame]remove NA

```{r}
sum(is.na(dfAlc))
dfAlc[is.na(dfAlc)] = 0
View(dfAlc)
```

3.[ifelse][all]

```{r}
if(all(dfAlc$aconsum < 30)){
  print("World Alcochol rate is under 30")
} else{
  print("World Alcochol rate is not under 30")
}
```

3.[ifelse]

```{r}
str(dfAlc)
x <- dfAlc$country
xCharCountry <- nchar(x)
y <- dfAlc$abbrv
changeCountryToAbbrv<- ifelse(xCharCountry >2,y,x)
changeCountryToAbbrv
```

3.[any] take a vector of logicals ; return true, if any of the entries is true 

```{r}
x <- c(TRUE, FALSE)
any(x)
```

3.[all] take a vector of logicals; return  TRUE, if all the entries are true 

```{r}
x <- c(TRUE, FALSE)
all(x)
```

4.[function]

```{r}
avg <- function(x){
  s <- sum(x)
  n <- length(x)# Note:  not saved in the work space; the values of the variables are changed only during the F's call
  s/n
} 
x<- dfAlc$urbanrt
identical (mean(x),avg(x))
```

4.[function]

```{r}
avg <- function(x,arithmetic=TRUE){ # calculate either geometric, or arithmetic average depending on predefined variable
    n <- length(x)
    arithmetic <-sum(x)/n
    geometric<- prod(x)^(1/n)
    ifelse(arithmetic,arithmetic,geometric)
  }
x<- dfAlc$urbanrt
avg(x)
```

3.[forloop]

```{r}
compute_s_n <- function(n){
    x<- 1:n
    sum(x) 
  }
compute_s_n(3)
m <-25 
s_n <- vector(length = m)#create an empty vector for storing
for(n in 1:m){
  s_n[n] <- compute_s_n(n)
}
n <- 1:m
plot(n,s_n)
lines(n,n*(n+1)/2)
```

3.[forloop]

```{r}
sum <- 0
for(i in 1:2) 
  sum <- sum + i^2
sum
```


2.[ggplot]

```{r}
abbCountry <- dfAlc$abbrv 
suicidesPer100 <- dfAlc$suicideper100
urbanRT <- dfAlc$urbanrt
region <- dfAlc$region
ranksAConsumption <- rank(dfAlc$aconsum,na.last = NA)
i <- order(dfAlc$aconsum)
df<- data.frame(country = abbCountry[i], suicide = suicidesPer100[i], rank = ranksAConsumption[i],urbanrate = urbanRT[i],region = region[i])
df %>%
  ggplot(aes(urbanrate, suicide, label=country,color=rank)) + geom_label()

```

2.[ggplot]

```{r echo=TRUE, message=FALSE, warning=FALSE}
dfAlc %>%
  ggplot(aes(urbanrt, employrt, label=abbrv, color=region)) + geom_label()
```

2.[ggplot]

```{r echo=TRUE, message=FALSE, warning=FALSE}
dfAlc %>%
  ggplot(aes(urbanrt, employrt, label=abbrv, color=region)) + geom_label()
```

2.[scatterPlot]

```{r}
plot(dfAlc$suicideper100,dfAlc$aconsum, xlab = "suicides/100 people", ylab="alcohol consumption")
plot(dfAlc$employrt,dfAlc$aconsum, xlab = "employee rate", ylab="alcohol consumption")
plot(dfAlc$urbanrt,dfAlc$aconsum, xlab = "urban rate", ylab="alcohol consumption")
```

2.[scatterPlot] in logs

```{r}
log10IncomePer1 <- log10(dfAlc$incomeper1)
log10Aconsum <- log10(dfAlc$aconsum)
plot(log10IncomePer1,log10Aconsum)
```

2.[histogram]

```{r}
hist(dfAlc$aconsum,xlab = "alcohol consumption") 
dfAlc$country[which.max(dfAlc$aconsum)]
```

2.[boxplot]

```{r}
boxplot(aconsum~region, data = dfAlc,na.action = NULL) 
boxplot(suicidesPer100~region, data = dfAlc)
boxplot(employrt~region, data = dfAlc)
boxplot(urbanrt~region, data = dfAlc)
```


## II.

## Libraries

> library load 

```{r}
library(UsingR)
```

1.[dataFrame]filter

```{r}
controlsXGaze <- dplyr::filter(dfPonzo, stimulusNr == c(1,3,13,15,25,27)) %>% dplyr::select(xGaze) %>% summarise(mean(xGaze))
controlsXGaze
controlsYGaze <-dplyr::filter(dfPonzo, stimulusNr == c(1,3,13,15,25,27)) %>% dplyr::select(yGaze) %>% summarise(mean(yGaze))
controlsYGaze
```

1.[dataFrame] pipe filter select unlist

```{r}
controlsXGaze <- dplyr::filter(dfPonzo, stimulusNr == c(1,3,13,15,25,27)) %>% dplyr::select(xGaze) 
mean(controlsXGaze$xGaze)
controlsYGaze <-dplyr::filter(dfPonzo, stimulusNr == c(1,3,13,15,25,27)) %>% dplyr::select(yGaze)
mean(controlsYGaze$yGaze)
longUpXGaze  <-dplyr::filter(dfPonzo, stimulusNr == c(5,7,17,19,29,31))%>% dplyr::select(xGaze)
mean(longUpXGaze$xGaze)
longUpYGaze  <-dplyr::filter(dfPonzo, stimulusNr == c(5,7,17,19,29,31))%>% dplyr::select(yGaze)
mean(longUpYGaze$yGaze)
longDownXGaze<- dplyr::filter(dfPonzo, stimulusNr == c(9,11,21,23,33,35))%>% dplyr::select(xGaze)
mean(longDownXGaze$xGaze)
longDownYGaze<- dplyr::filter(dfPonzo, stimulusNr == c(9,11,21,23,33,35))%>% dplyr::select(yGaze)
mean(longDownYGaze$yGaze)
```

1.[dataFrame] filter select

```{r}
controls <- dplyr::filter(dfPonzo, stimulusNr == c(1,3,13,15,25,27)) 
head(controls)
View(controls)
mean(controls$xGaze)
mean(controls$yGaze)
longUp  <-dplyr::filter(dfPonzo, stimulusNr == c(5,7,17,19,29,31))
head(longUp)
View(longUp)
mean(longUp$xGaze)
mean(longUp$yGaze)
longDown <- dplyr::filter(dfPonzo, stimulusNr == c(9,11,21,23,33,35))
head(longDown)
View(longDown)
mean(longDown$xGaze)
mean(longDown$yGaze)
```

1.[dataFrame] turn into numeric vector

```{r}
unlist(controls)
unlist(longUp)
unlist(longDown)
```

3.[plot]

```{r}
plot(controls$xGaze,controls$yGaze,xlab = "controlsXGaze", ylab="controlsYGaze") 
plot(longUp$xGaze,longUp$yGaze,xlab = "longUpXGaze", ylab="longUpYGaze") 
plot(longDown$xGaze,longDown$yGaze,xlab = "longDownXGaze", ylab="longDownYGaze") 
```

1.[population]get different random sample of 12;random variable of random sample

```{r}
popDfPonzoXGaze <- unlist(dfPonzo$xGaze)
popDfPonzoYGaze <- unlist(dfPonzo$yGaze)
mean(sample(popDfPonzoXGaze,12))
mean(sample(popDfPonzoYGaze,12))
mean(popDfPonzoXGaze)
mean(popDfPonzoYGaze)
```

1.[seed] set/ produce the same sample again and again = generate same set at each time

```{r}
set.seed(1) 
```

1.[average] difference between the average of the sample and the average of the pop

```{r}
sampleDfPonzoXGaze<- sample(popDfPonzoXGaze,5)
abs(mean(sampleDfPonzoXGaze)-mean(popDfPonzoXGaze))
sampleDfPonzoYGaze<- sample(popDfPonzoYGaze,5)
abs(mean(sampleDfPonzoYGaze)-mean(popDfPonzoYGaze))
```

1.[seed] set/ produce the same sample again and again = generate same set at each time by setting the starting number used to generate a sequence of random numbers

```{r}
set.seed(5) 
```

1.[average] difference between the average of the sample and the average of the pop

```{r}
sampleDfPonzoXGaze<- sample(popDfPonzoXGaze,5)
abs(mean(sampleDfPonzoXGaze)-mean(popDfPonzoXGaze))
sampleDfPonzoYGaze<- sample(popDfPonzoYGaze,5)
abs(mean(sampleDfPonzoYGaze)-mean(popDfPonzoYGaze))
```

###### ^1^ Note: the average of the samples is a random variable =>inferential statistics needed

1.[nullDistribution] all possible realizations under the null 

```{r}
obslongUpControlsX <- mean(longUp$xGaze) - mean(controls$xGaze)
obslongUpControlsY <- mean(longUp$yGaze) - mean(controls$yGaze)
obslongDownControls <- mean(longDown$xGaze) - mean(controls$xGaze)
obslongDownControls <- mean(longDown$yGaze) - mean(controls$yGaze)
popDfPonzoXGaze <- unlist(dfPonzo$xGaze)
popDfPonzoXGaze <- unlist(dfPonzo$yGaze)
popDfPonzoControls <- sample(popDfPonzoXGaze,12)
popDfPonzoLongUp <- sample(popDfPonzoXGaze,12)
mean(popDfPonzoLongUp) - mean(popDfPonzoControls)
popDfPonzoControlsY <- sample(popDfPonzoYGaze,12)
popDfPonzoLongUpY <- sample(popDfPonzoYGaze,12)
mean(popDfPonzoLongUpY) - mean(popDfPonzoControlsY)
```

###### ^1^ Note: do sampling and substraction multiple times = see several realizations of the difference in mean  for the null hypothesis

1.[nullHypothesis] check 

```{r}
n<-10000
nullsPopX <- vector("numeric",n)
for(i in 1:n){
  popDfPonzoControlsX <- sample(popDfPonzoXGaze,12)
  popDfPonzoLongUpX <- sample(popDfPonzoXGaze,12)
  nullsPopX[i]<- mean(popDfPonzoLongUpX) - mean(popDfPonzoControlsX)
}
max(nullsPopX)
hist(nullsPopX)
```

```{r}
n<-10000
nullsPopY <- vector("numeric",n)
for(i in 1:n){
  popDfPonzoControlsY <- sample(popDfPonzoYGaze,12)
  popDfPonzoLongUpY <- sample(popDfPonzoYGaze,12)
  nullsPopY[i]<- mean(popDfPonzoLongUpY) - mean(popDfPonzoControlsY)
}
max(nullsPopY)
hist(nullsPopY)
```

###### ^1^ Note: if knowing the null distribution, one can describe the proportion of values one sees for any interval of values -> define a number of times to redo the null hypothesis check; record all differences  

1.[nullHypothesis] #1 option: how often (frequency) null values are bigger or not than observed values 
```{r}
sum(nullsPopX > obslongUpControlsX)/n 
sum(nullsPopY > obslongUpControlsY)/n 
```

1.[nullHypothesis] #2 option: proportion of times the null is bigger than the observation 

```{r}
mean(nullsPopX > obslongUpControlsX)
mean(nullsPopY > obslongUpControlsY)
```

1.[pValue] probability that an outcome from the null distribution is bigger than what one observed when the null hypothesis is true 

```{r}
mean(abs(nullsPopX) >obslongUpControlsX)
mean(abs(nullsPopY) >obslongUpControlsY)
```

###### ^1^ Note: #3 option: how often (frequency) it is bigger in absolute 

1.[nullDistribution] loop for 1000 times taking a random sample of 5 gazes calculating the mean and storing it within an averages vector 

```{r}
head(popDfPonzoXGaze)
set.seed(1)
n<-1000
averagesPopX <- vector("numeric",n)
for(i in 1:n){
  X <- sample(popDfPonzoXGaze,5)#using a for-loop take a random sample of 5 gazes 1,000 times ; save these averages
  averagesPopX[i]<- mean(X)
}
```

```{r}
hist(averagesPopX)
```

1.[nullHypothesis] check 

```{r}
mean( abs( averagesPopX - mean(popDfPonzoXGaze) ) > 0.05) #What proportion of these 1,000 averages are more than 0.05%  away from the average of mean(X) ?
```

1.[nullDistribution] loop for 10000 times taking a random sample of 5 gazes calculating the mean and storing it within an averages vector 

```{r}
head(popDfPonzoXGaze)
set.seed(1)
n<-10000
averagesPopX <- vector("numeric",n)
for(i in 1:n){
  X <- sample(popDfPonzoXGaze,5)#using a for-loop take a random sample of 5 gazes 10000 times ; save these averages
  averagesPopX[i]<- mean(X)
}
```

```{r}
hist(averagesPopX)
```

1.[nullHypothesis] check 

```{r}
mean( abs( averagesPopX - mean(popDfPonzoXGaze) ) > 0.05) #What proportion of these 10000 averages are more than 0.05%  away from the average of mean(X) ?
```

1.[nullDistribution] loop for 10000 times taking a random sample of 5 gazes calculating the mean and storing it within an averages vector 

```{r}
head(popDfPonzoYGaze)
set.seed(1)
n<-1000
averagesPopY <- vector("numeric",n)
for(i in 1:n){
  Y <- sample(popDfPonzoYGaze,5)#using a for-loop take a random sample of 5 gazes 1,000 times ; save these averages
  averagesPopY[i]<- mean(Y)
}
```

```{r}
hist(averagesPopY)
```

1.[nullHypothesis] check 

```{r}
mean( abs( averagesPopY - mean(popDfPonzoYGaze) ) > 0.05)#What proportion of these 1,000 averages are more than 0.05%  away from the average of mean(Y) ?
```

1.[normalApproximation] describe distribution = describe the entier list

```{r}
head(popDfPonzoXGaze)
mean(popDfPonzoXGaze <= 0.500)
prop = function(q) {
  mean(popDfPonzoXGaze <= q)
}
qs<- seq(from = min(popDfPonzoXGaze), to = max(popDfPonzoXGaze), length=20)
props = sapply(qs,prop)
props = sapply(qs, function(q) mean(popDfPonzoXGaze <= q))
```

1.[normalApproximation] plot

```{r}
plot(qs, props)
```

###### ^1^ Note: #1 option: empirical cumulative distribution function 

1.[normalApproximation] describe distribution = describe the entier list => empirical cumulative distribution function 

```{r}
plot(ecdf(popDfPonzoXGaze))
```

###### ^1^ Note: #2 option: empirical cumulative distribution function 


1.[centralLimitTheorem] 

```{r}
head(popDfPonzoXGaze)
set.seed(1)
n<-1000
averagesPopX5 <- vector("numeric",n)
for(i in 1:n){
  X <- sample(popDfPonzoXGaze,5)#using a for-loop take a random sample of 5 mice 1,000 times ; Save these averages
  averagesPopX5[i]<- mean(X)
}
```

```{r}
head(popDfPonzoXGaze)
set.seed(1)
n<-1000
averagesPopX50 <- vector("numeric",n)
for(i in 1:n){
  X <- sample(popDfPonzoXGaze,50)#using a for-loop take a random sample of 5 mice 1,000 times ; Save these averages
  averagesPopX50[i]<- mean(X)
}
```

```{r}
par(mfrow = c(2,1))
hist(averagesPopX5)
hist(averagesPopX50)  
```

```{r}
mean(averagesPopX5<0.600 & averagesPopX5>0.400)
mean(averagesPopX50<0.600 & averagesPopX50>0.400)
```

###### ^1^ Note: for the last set of averages, the ones obtained from a sample size of 5 vs. 50, what proportion are between 0.400 and 0.600? 

```{r}
mu <- mean(averagesPopX50)
mu
sigma <- sd(averagesPopX50)
sigma
```

1. [pNorm] find  proportion of observations below a cutoff x given a normal distribution with mean mu and standard deviation sigma with pnorm(x, mu, sigma) or pnorm( (x-mu)/sigma )

```{r}
pnorm(0.600, mu, sigma) - pnorm(0.400,mu,sigma)  
```

###### ^1^ Note: What is the proportion of observations between 0.600 and 0.400 in a normal distribution with mu and sd?

1.[centralLimitTheorem]

```{r}
popMean <- mean(popDfPonzoXGaze)
popSD <- sd(popDfPonzoXGaze)
propWithinOneSDX<- (popDfPonzoXGaze-popMean)/popSD
mean(abs(propWithinOneSDX) <=1) #What proportion of xGaze% are within 1 SD away from the average Gaze%?
mean(abs(propWithinOneSDX) <=2)#What proportion of xGaze% are within 2 SD away from the average Gaze%?
mean(abs(propWithinOneSDX) <=3) #What proportion of xGaze% are within 3 SD away from the average Gaze%?
popMean <- mean(popDfPonzoYGaze)
popSD <- sd(popDfPonzoYGaze)
propWithinOneSDY<- (popDfPonzoYGaze-popMean)/popSD
mean(abs(propWithinOneSDY) <=1) #What proportion of xGaze% are within 1 SD away from the average Gaze%?
mean(abs(propWithinOneSDY) <=2)#What proportion of xGaze% are within 2 SD away from the average Gaze%?
mean(abs(propWithinOneSDY) <=3) #What proportion of xGaze% are within 3 SD away from the average Gaze%?
```

> library load 

```{r}
library(rafalib)
```

```{r}
qqnorm(popDfPonzoXGaze)
abline(0,1)
qqnorm(popDfPonzoYGaze)
abline(0,1)
```

> library load 

```{r}
library(dplyr)
```

```{r}
avgs <- replicate(10000, mean( sample(popDfPonzoXGaze, 25)))
mypar(1,2)
hist(avgs)
qqnorm(avgs)
qqline(avgs)
mean(avgs) #What is the average of the distribution of the sample average?
```

> library load 

```{r}
library(rafalib)
```

```{r}
sd(avgs)#What is the standard deviation of the distribution of sample averages (use popsd())?
```

> library load 

```{r}
library(dplyr)
```

1.[centralLimitTheorem] practice

###### ^1^ Note: the NUll distirbution is very well approximated by a normal distribution; checkwhether normal approximation applies

```{r}
obslongUpControlsX <- mean(longUp$xGaze) - mean(controls$xGaze)
obslongUpControlsY <- mean(longUp$yGaze) - mean(controls$yGaze)
popDfPonzoXGaze <- unlist(dfPonzo$xGaze)
popDfPonzoYGaze <- unlist(dfPonzo$yGaze)
```

```{r}
popDfPonzoControlsX <- sample(popDfPonzoXGaze,12)
popDfPonzoLongUpX <- sample(popDfPonzoXGaze,12)
mean(popDfPonzoLongUpX) - mean(popDfPonzoControlsX)#random sample;get different random sample of 12;random variable of random sample
popDfPonzoControlsY <- sample(popDfPonzoYGaze,12)
popDfPonzoLongUpY <- sample(popDfPonzoYGaze,12)
mean(popDfPonzoLongUpY) - mean(popDfPonzoControlsY)
```

###### ^1^ Note: if knowing the null distribution, one can describe the proportion of values one sees for any interval of values 
###### ^1^ Note: define a number of times to redo the null hypothesis check; record all differences

```{r}
n<-10000
nullsPopX <- vector("numeric",n)
for(i in 1:n){
  popDfPonzoControlsX <- sample(popDfPonzoXGaze,12)
  popDfPonzoLongUpX <- sample(popDfPonzoXGaze,12)
  nullsPopX[i]<- mean(popDfPonzoLongUpX) - mean(popDfPonzoControlsX)
}
max(nullsPopX)
hist(nullsPopX)
```
```{r}
n<-10000
nullsPopY <- vector("numeric",n)
for(i in 1:n){
  popDfPonzoControlsY <- sample(popDfPonzoYGaze,12)
  popDfPonzoLongUpY <- sample(popDfPonzoYGaze,12)
  nullsPopY[i]<- mean(popDfPonzoLongUpY) - mean(popDfPonzoControlsY)
}
max(nullsPopY)
hist(nullsPopY)
```

1.[nullHypothesis]

```{r}
sum(nullsPopX > obslongUpControlsX)/n #1 option: how often null values are bigger or not than observed values 
sum(nullsPopY > obslongUpControlsY)/n 
```

```{r}
mean(nullsPopX >obslongUpControlsX) #2 option: proportion of times the null is bigger than the observation 
mean(nullsPopY >obslongUpControlsY)
```

```{r}
mean(abs(nullsPopX) >obslongUpControlsX)#3 option: how often it is bigger in absolute 
mean(abs(nullsPopY) >obslongUpControlsY)
```

###### ^1^ Note: p value = the probability that an outcome from the null distribution is bigger than what one observed when the null hypothesis is true 

> library load 

```{r}
library(rafalib)
```

```{r}
mypar()
qqnorm(nullsPopX)
qqline(nullsPopX)
qqnorm(nullsPopY)
qqline(nullsPopY)
```
###### ^1^ Note: use normal approximation instead of accessing the population through changes of the sample 

> library load 

```{r}
library(dplyr)
```

1.[tTest]

```{r}
N <- length(controlsXGaze)
se <- sqrt(var(longUpXGaze)/N+ #square root of the variance of the sample estimate of the variance divided by N=sample size
               var(controlsXGaze)/N) #gives us standard error estimate
tstatX <- obslongUpControlsX/se
tstatX
library(dplyr)
N <- length(controlsYGaze)
se <- sqrt(var(longUpYGaze)/N+ 
             var(controlsYGaze)/N) 
tstatY <- obslongUpControlsY/se
tstatY
```

```{r}
1- pnorm(tstatX) #what proportion of normally distributed data, with means 0 and standard deviation 1,are lower than whatever value you put here
2*(1- pnorm(tstatX))
1- pnorm(tstatY) 
2*(1- pnorm(tstatY))
```

```{r}
n<-10000
nullsPopX <- vector("numeric",n)
for(i in 1:n){
  popDfPonzoControlsX <- sample(popDfPonzoXGaze,12)
  popDfPonzoLongUpX <- sample(popDfPonzoXGaze,12)
  nullsPopX[i]<- mean(popDfPonzoLongUpX) - mean(popDfPonzoControlsX)
}

n<-10000
nullsPopY <- vector("numeric",n)
for(i in 1:n){
  popDfPonzoControlsY <- sample(popDfPonzoYGaze,12)
  popDfPonzoLongUpY <- sample(popDfPonzoYGaze,12)
  nullsPopY[i]<- mean(popDfPonzoLongUpY) - mean(popDfPonzoControlsY)
}
```

###### ^1^ Note: how good of an approximation this is => access the population 

> library load 

```{r}
library(rafalib)
```

```{r}
mypar()
qqnorm(nullsPopX)
abline(0,1)
qqline(nullsPopX)
qqnorm(nullsPopY)
abline(0,1)
qqline(nullsPopY)
```


## III.

1.[vector] discrete numeric data  considered ordinal-ly 

```{r}
unique(dfAlc$employrt)
length(unique(dfAlc$employrt))
```

1.[vector] compute the frequencies of each unique value 

```{r}
table(dfAlc$employrt)
prop.table(table(dfAlc$region))
```

1.[vector] sum frequencies 

```{r}
sum(table(dfAlc$employrt)==1)
```

> load library

```{r}
library(dplyr)
```

1.[column] remove NAs 

```{r}
dfAlc[is.na(x = dfAlc)] <- 0
```

1.[CDF] cumulative distribution function for continuous data 

```{r}
rangeForCdfFunction <- seq(min(dfAlc$employrt), max(dfAlc$employrt),length = 100) #define range of values spanning the dataset 
cdfFunction <- function(f){ # computes probability for a single value
  mean(dfAlc$employrt<=f) # cdfFunction (rangeForCdfFunction) = Pr (f</=rangeForCdfFunction) 
}
cdfValuesBelow <- sapply(rangeForCdfFunction,cdfFunction)#  CDF defines proportion of data below the  cutoff rangeForCdfFunction
cdfValuesAbove <- 1-(sapply(rangeForCdfFunction,cdfFunction)) # defines proportion of data above the  cutoff rangeForCdfFunction => 1 - cdfFunction (rangeForCdfFunction)
```

3.[plot] CDF 

```{r}
plot(rangeForCdfFunction,cdfValuesBelow)
EmployeeRate <- rangeForCdfFunction
Proportion<- cdfValuesBelow
plot(EmployeeRate,Proportion)
plot(rangeForCdfFunction,cdfValuesAbove) 
```

```{r}
rangeForCdfFunctionQ <- seq(quantile(dfAlc$employrt,0.50), quantile(dfAlc$employrt,0.75),length = 100) 
cdfFunction <- function(f){ 
  mean(dfAlc$employrt<=f)  
}
cdfValuesBellowQ <- sapply(rangeForCdfFunctionQ,cdfFunction) - (sapply(rangeForCdfFunction,cdfFunction)) # define proportion of values between rangeForCdfFunction and rangeForCdfFunctionQ
plot(rangeForCdfFunctionQ,cdfValuesBellowQ)

```

1.[column] mean and standard deviation 

```{r}
meanDfAlcEmpRate <- sum(dfAlc$employrt)/ length(dfAlc$employrt)
sdDfAlcEmpRate <- sqrt(sum((dfAlc$employrt-meanDfAlcEmpRate)^2)/ length(dfAlc$employrt))
```

1.[column] filter; access through index; calculate mean and standard deviation 

```{r}
iEMEA <- dfAlc$region == "EMEA" 
xEMEAEmplRt <- dfAlc$employrt[iEMEA]
mEMEAEmplRt <- mean(xEMEAEmplRt)
sdEMEAEmplRt <- sd(xEMEAEmplRt)
c(mEMEAEmplRt=mEMEAEmplRt,sdEMEAEmplRt=sdEMEAEmplRt)
```

1.[mean] within range 

```{r}
mean(xEMEAEmplRt>49 & xEMEAEmplRt<=52)
```

1.[zScore] scale

```{r}
zEMEAEmplRt = scale(xEMEAEmplRt) # converts a vector of approximatley normally distributed values into z-scores
```

1.[zScore] check whether significantly above or below the mean  

```{r}
mean(abs(zEMEAEmplRt)<2)  # compute proportion of observations that are within 2 standard deviations of the mean 
mean(abs(xEMEAEmplRt)<2) 
```

1[median] absolute deviation
 
```{r}
mad(xEMEAEmplRt) # median absolute deviation
```

1.[pnorm] approximate the proportion of the data without access to actual data 

```{r}
mean(xEMEAEmplRt>49 & xEMEAEmplRt<=52)  
pnorm(72, mean(xEMEAEmplRt),sd(xEMEAEmplRt))- pnorm(69,  mean(xEMEAEmplRt),sd(xEMEAEmplRt)) 
```

###### ^1^ Note:the approximation calculated with the pnorm is very close to the exact calculation with the mean 

1.[pnorm] approximation is not always useful  for the more extreme values - tails

```{r}
exact <- mean(xEMEAEmplRt > 21 & xEMEAEmplRt <= 23) # calculate the proportion of heights between 79 and 81
avg <- mean(xEMEAEmplRt)
sd <- sd(xEMEAEmplRt)
approx <- pnorm(81, avg, sd) - pnorm(79, avg, sd)# estimate the proportion of heights between 79 and 81 
exact/approx # report how many times bigger the actual proportion is compared to the approximation
```


1.[pnorm] mathematically define CDF

```{r}
1 - pnorm(45, mean(xEMEAEmplRt),sd(xEMEAEmplRt)) #whether the probability that a randomly selected employRt is bigger than 45
```

1.[plot] proportion table

```{r}
plot(prop.table(table(xEMEAEmplRt)), xlab = "a = EMEAEmplRt", ylab = "Pr(xEMEAEmplRt = a)")
```

1.[vector] quantile

```{r}
p <- seq(0.01, 0.99, 0.01)
quantile(p)
```

1.[vector] percentiles 

```{r}
percentiles <- quantile(xEMEAEmplRt,p)
percentiles[names(percentiles) == "25%"]
percentiles[names(percentiles) == "50%"]
percentiles[names(percentiles) == "75%"]
```

1.[vector] quartile

```{r}
summary(xEMEAEmplRt)
```

1.[vector] theoretical quantile

```{r}
p <- seq(0.01, 0.99, 0.01)
qnorm(p, mean(xEMEAEmplRt), sd(xEMEAEmplRt))
```

1.[vector] observed and theoretical quantile

```{r}
summary(xEMEAEmplRt)
mean(xEMEAEmplRt <= 54)# proportion of data below 68.5
p <- seq(0.05,0.95,0.05)
observedQuantiles <- quantile(xEMEAEmplRt,p)
theoreticalQuantiles <- qnorm(p, mean = mean(xEMEAEmplRt), sd = sd(xEMEAEmplRt))
```

1.[plot] observed and theoretical quantile

```{r}
plot(theoreticalQuantiles, observedQuantiles)
abline(0,1)
```

1.[vector] observed and theoretical quantile

```{r}
z <- scale(xEMEAEmplRt)
observedQuantiles <- quantile(z,p)# if standard units are used no need of defining the mean and the standard deviation 
theoreticalQuantiles <- qnorm(p) 
```

1.[plot] observed and theoretical quantile

```{r}
plot(theoreticalQuantiles, observedQuantiles)
abline(0,1)
```

> load library 

```{r}
library(dslabs)
```

1.[vector] filter

```{r}
iEMEA <- dfAlc$region == "EMEA"
iAPAC <- dfAlc$region == "APAC"
xEMEAEmplRt <- dfAlc$employrt[iEMEA]
xAPACEmplRt <- dfAlc$employrt[iAPAC]
```

1.[dataFrame] filter, group by, summarize

```{r}
  dfAlc %>%
  group_by(region) %>%
  dplyr::summarize(average = mean(aconsum), standard_deviation = sd(aconsum))
```

###### ^1^ Note: group data frame = as many tables with the same columns but not necessarily the same rows that are stacked together into one object
###### ^1^ Note: group_by() function from dplyr  converts a data frame to a grouped data frame, creating groups using one or more variables

1.[dataFrame] arrange by ascend 

```{r}
  dfAlc %>% arrange(aconsum) %>% head()
```

1.[dataFrame] arrange by descend 

```{r}
 dfAlc %>% arrange(desc(aconsum)) %>% head()
```

1.[dataFrame] nested arrange  

```{r}
 dfAlc %>% arrange(region, aconsum) %>% head()
```

1.[dataFrame] top 10, not ordered by 

```{r}
 dfAlc %>% top_n(10, aconsum)
```

1.[dataFrame] top 10,ordered by 

```{r}
dfAlc %>% arrange(desc(aconsum)) %>% top_n(10)
dfAlc %>% slice_max(aconsum, n = 10) #alternative 
```

1.[dataFrame]  top 10 nested arrange by region ,ordered by 

```{r}
dfAlc %>% arrange(desc(region, aconsum))  %>% top_n(10) 
```

1.[quantile] observed and theoretical calculate

```{r}
percentilesEMEA <- quantile(xEMEAEmplRt, seq(.01, 0.99, 0.01))
percentilesAPAC <- quantile(xAPACEmplRt, seq(.01, 0.99, 0.01))
theoreticalQuantilesEMEA <- qnorm(seq(.01, 0.99, 0.01), mean = mean(xAPACEmplRt), sd = sd(xAPACEmplRt))
theoreticalQuantilesAPAC <- qnorm(seq(.01, 0.99, 0.01), mean = mean(xAPACEmplRt), sd = sd(xAPACEmplRt))
```

1.[percentile] calculate

```{r}
EMEApercentiles <- c(percentilesEMEA[names(percentilesEMEA) == "10%"],percentilesEMEA[names(percentilesEMEA) == "30%"],percentilesEMEA[names(percentilesEMEA) == "50%"],percentilesEMEA[names(percentilesEMEA) == "70%"],percentilesEMEA[names(percentilesEMEA) == "90%"])
APACpercentiles <- c(percentilesAPAC[names(percentilesAPAC) == "10%"],percentilesAPAC[names(percentilesAPAC) == "30%"],percentilesAPAC[names(percentilesAPAC) == "50%"],percentilesAPAC[names(percentilesAPAC) == "70%"],percentilesAPAC[names(percentilesAPAC) == "90%"])

```

3.[plot] observed and theoretical quantiles calculate

```{r}
plot(theoreticalQuantilesEMEA, percentilesEMEA)
abline(0,1)
plot(theoreticalQuantilesAPAC, percentilesAPAC)
abline(0,1)
```

1.[zScore] scale

```{r}
zEMEA <- scale(xEMEAEmplRt)
zAPAC <- scale(xAPACEmplRt)
```

1.[quantile] observed and theoretical calculate

```{r}
percentilesEMEA <- quantile(zEMEA, seq(.01, 0.99, 0.01))
percentilesAPAC <- quantile(zAPAC, seq(.01, 0.99, 0.01))
theoreticalQuantilesEMEA <- qnorm(seq(.01, 0.99, 0.01))
theoreticalQuantilesAPAC <- qnorm(seq(.01, 0.99, 0.01))
```

3.[plot] observed and theoretical quantiles calculate

```{r}
plot(theoreticalQuantilesEMEA, percentilesEMEA)
abline(0,1)
plot(theoreticalQuantilesAPAC, percentilesAPAC)
abline(0,1)
```

1.[outlier] check error 

```{r}
     error_avg <- function(k){
    dfAlc$employrt[1]<-k
    mean(dfAlc$employrt)
  }
error_avg (10000)
error_avg (-10000)
  
```

1.[ggplot] define

```{r}
dfAlc %>% ggplot
ggplotdfAlc <- ggplot(data=dfAlc) 
class(ggplotdfAlc) 
print(ggplotdfAlc)
```

1.[ggplot] define variables and observations 

```{r}
head(dfAlc)
dfAlc %>% 
  filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = employrt, y = aconsum ),show.legend = TRUE)
dfAlc %>% 
  filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = urbanrt, y = aconsum ),show.legend = TRUE)
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = suicideper100, y = aconsum ),show.legend = TRUE)
```

1.[ggplot] plot defined

```{r}
gridExtra::grid.arrange(dfAlc %>% 
                           filter(region == "EMEA")%>% 
                          ggplot() +
                          geom_point(aes(x = employrt, y = aconsum ),show.legend = TRUE),
                        dfAlc %>% 
                           filter(region == "EMEA")%>% 
                          ggplot() +
                          geom_point(aes(x = urbanrt, y = aconsum ),show.legend = TRUE),
                        dfAlc %>% 
                           filter(region == "EMEA")%>% 
                          ggplot() +
                          geom_point(aes(x = suicideper100, y = aconsum ),show.legend = TRUE),
                        ncol = 3)
```

1.[ggplot] label text

```{r}
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = employrt, y = aconsum ),show.legend = TRUE) +
  geom_text(aes(x = employrt, y = aconsum, label = abbrv ))
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = urbanrt, y = aconsum ),show.legend = TRUE)+
  geom_text(aes(x = urbanrt, y = aconsum, label = abbrv ))
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = suicideper100, y = aconsum ),show.legend = TRUE)+
  geom_text(aes(x = suicideper100, y = aconsum, label = abbrv ))
```

1.[ggplot] plot label text

```{r}
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot(aes(x = employrt, y = aconsum, label = abbrv )) +
  geom_label()
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot(aes(x = urbanrt, y = aconsum, label = abbrv )) +
  geom_label()
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot(aes(x = suicideper100, y = aconsum, label = abbrv )) +
  geom_label()
```

1.[ggplot] change point size 

```{r}
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = employrt, y = aconsum ),show.legend = TRUE ,size = 0.6) +
  geom_text(aes(x = employrt, y = aconsum, label = abbrv ))
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = urbanrt, y = aconsum ),show.legend = TRUE,size = 0.6)+
  geom_text(aes(x = urbanrt, y = aconsum, label = abbrv ))
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = suicideper100, y = aconsum ),show.legend = TRUE,size = 0.6)+
  geom_text(aes(x = suicideper100, y = aconsum, label = abbrv ))
```

1.[ggplot] change point size relative to the frequency of the observations 

```{r}
dfAlc %>% 
  filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = employrt, y = aconsum,size = aconsum ),alpha= 0.5,show.legend = TRUE) +
  geom_text(aes(x = employrt, y = aconsum, label = abbrv ))
dfAlc %>% 
   filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = urbanrt, y = aconsum,size = aconsum ),alpha= 0.5,show.legend = TRUE)+
  geom_text(aes(x = urbanrt, y = aconsum, label = abbrv ))
dfAlc %>% 
  filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = suicideper100, y = aconsum,size = aconsum ),alpha= 0.5,show.legend = TRUE)+
  geom_text(aes(x = suicideper100, y = aconsum, label = abbrv ))
```

1.[ggplot] bubblechart 

```{r}
dfAlc %>% 
  filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = employrt, y = aconsum,size = urbanrt,color = suicideper100 ),alpha=0.5) +
  scale_size(range = c(.5, 20), name="urbanrt")+
  ggrepel::geom_text_repel(
    aes(x = employrt, y = aconsum, label = abbrv, point.size = suicideper100), 
    size = 4, # font size in the text labels
    point.padding = 0, #  padding around each point
    min.segment.length = 0, # draw all line segments
    box.padding = 0.7, #padding around each text label
    max.overlaps = 100
  ) +
  theme(legend.position = "right")
```


1.[ggplot] label position relative to point 

```{r}
dfAlc %>% 
  filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = employrt, y = aconsum ),show.legend = TRUE ,size = 0.6) +
  geom_text(aes(x = employrt, y = aconsum, label = abbrv ), nudge_x = 1 ,nudge_y = 0.5)
dfAlc %>% 
  filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = urbanrt, y = aconsum ),show.legend = TRUE ,size = 0.6)+
  geom_text(aes(x = urbanrt, y = aconsum, label = abbrv ),nudge_x = 1 ,nudge_y = 0.5)
dfAlc %>% 
  filter(region == "EMEA")%>% 
  ggplot() +
  geom_point(aes(x = suicideper100, y = aconsum ),show.legend = TRUE ,size = 0.6)+
  geom_text(aes(x = suicideper100, y = aconsum, label = abbrv ),nudge_x = 1 ,nudge_y = 0.5)
```

1.[ggplot] global aesthetic mapping 

```{r}
ggplotDfAlcAlconsumEmplRt <- dfAlc %>% filter(region == "EMEA")%>% ggplot(aes(employrt,aconsum,label = abbrv))
ggplotDfAlcAlconsumEmplRt + 
  geom_point(size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)
ggplotDfAlcAlconsumUrbanRt <- dfAlc %>% filter(region == "EMEA")%>% ggplot(aes(urbanrt,aconsum,label = abbrv))
ggplotDfAlcAlconsumUrbanRt +
  geom_point(size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)
ggplotDfAlcAlconsumSuicide100<- dfAlc %>% filter(region == "EMEA")%>% ggplot(aes(suicideper100,aconsum,label = abbrv))
ggplotDfAlcAlconsumSuicide100 +
  geom_point(size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)
```

1.[ggplot] scale 

```{r}
dfAlc %>%
  filter(region == "EMEA")%>% 
  ggplot(aes(log2(aconsum))) +
  geom_histogram(binwidth = 1, fill ="lemonchiffon3" ,color = "lemonchiffon") 
dfAlc %>%
  filter(region == "EMEA")%>% 
  ggplot(aes(log2(employrt))) +
  geom_histogram(binwidth = 1, fill ="lightpink3" ,color = "lightpink") 
dfAlc %>%
  filter(region == "EMEA")%>% 
  ggplot(aes(log2(urbanrt))) +
  geom_histogram(binwidth = 1, fill = "lightgoldenrod3",color = "lightgoldenrod")
dfAlc %>%
  filter(region == "EMEA")%>% 
  ggplot(aes(log2(suicideper100))) +
  geom_histogram(binwidth = 1, fill = "lightblue3",color = "lightblue")
```

1.[ggplot] scale

```{r}
dfAlc %>%
  filter(region == "EMEA")%>% 
  ggplot(aes(aconsum)) +
  geom_histogram(binwidth = 1, fill ="lemonchiffon3" ,color = "lemonchiffon") +
 scale_x_continuous(trans = "log2")
dfAlc %>%
  filter(region == "EMEA")%>% 
  ggplot(aes(employrt)) +
  geom_histogram(binwidth = 1, fill ="lightpink3" ,color = "lightpink") +
  scale_x_continuous(trans = "log2")
dfAlc %>%
  filter(region == "EMEA")%>% 
  ggplot(aes(urbanrt)) +
  geom_histogram(binwidth = 1, fill = "lightgoldenrod3",color = "lightgoldenrod")+
  scale_x_continuous(trans = "log2")
dfAlc %>%
  filter(region == "EMEA")%>% 
  ggplot(aes(suicideper100)) +
  geom_histogram(binwidth = 1, fill = "lightblue3",color = "lightblue")+
  scale_x_continuous(trans = "log2")
```

1.[ggplot] change legend text and add title text

```{r}
ggplotDfAlcAlconsumEmplRt + 
  geom_point(size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Employment Rate")+
  ggtitle("EMEA Alcohol Consumption")
ggplotDfAlcAlconsumUrbanRt +
  geom_point(size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Urban Rate")+
  ggtitle("EMEA Alcohol Consumption")
ggplotDfAlcAlconsumSuicide100 +
  geom_point(size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/100 People")+
  ggtitle("EMEA Alcohol Consumption")
```

1.[ggplot] color 

```{r}
ggplotDfAlcAlconsumEmplRt + 
  geom_point(size=0.6,color ="red3")+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Employment Rate")+
  ggtitle("EMEA Alcohol Consumption")
ggplotDfAlcAlconsumUrbanRt +
  geom_point(size=0.6,color ="royalblue1")+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Urban Rate")+
  ggtitle("EMEA Alcohol Consumption")
ggplotDfAlcAlconsumSuicide100 +
  geom_point(size=0.6,color ="limegreen")+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/ 100 People")+
  ggtitle("EMEA Alcohol Consumption")
```
1.[ggplot] color to category 

```{r}
ggplotDfAlcAlconsumEmplRt + 
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Employment Rate")+
  ggtitle("EMEA Alcohol Consumption")
ggplotDfAlcAlconsumUrbanRt +
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Urban Rate")+
  ggtitle("EMEA Alcohol Consumption")
ggplotDfAlcAlconsumSuicide100 +
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/ 100 People")+
  ggtitle("EMEA Alcohol Consumption")
```
1.[ggplot] color to category 

```{r}
dfAlc %>% 
  ggplot(aes(x = employrt, y = aconsum, label = abbrv, color = region )) +
  geom_label() +
  geom_text(check_overlap = TRUE)
dfAlc %>% 
  ggplot(aes(x = urbanrt, y = aconsum, label = abbrv, color = region )) +
  geom_label() +
  geom_text(check_overlap = TRUE)
dfAlc %>% 
  ggplot(aes(x = suicideper100, y = aconsum, label = abbrv,color = region )) +
  geom_label()+
  geom_text(check_overlap = TRUE)

```

1.[ggplot] intercept extraction

```{r}
dfAlcEMEA <- dfAlc %>% filter(region == "EMEA")
lm.rAcEmp <- summary(lm(dfAlcEMEA$aconsum ~ dfAlcEMEA$employrt ))# intercept extraction 
lm.rAcUrb <- summary(lm(dfAlcEMEA$aconsum  ~ dfAlcEMEA$urbanrt)) # intercept extraction 
lm.rAcSu <- summary(lm(dfAlcEMEA$aconsum  ~ dfAlcEMEA$suicideper100)) # intercept extraction 

```

1.[plot] linear 

```{r}
plot(lm(dfAlcEMEA$aconsum ~ dfAlcEMEA$employrt  ))
plot(lm(dfAlcEMEA$aconsum  ~ dfAlcEMEA$urbanrt ))
plot(lm(dfAlcEMEA$aconsum  ~ dfAlcEMEA$suicideper100 ))
```

1.[ggplot] line representing the intercept 

```{r}
ggplotDfAlcAlconsumEmplRt + 
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Employment Rate")+ 
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept= 4.84388)
ggplotDfAlcAlconsumUrbanRt +
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Urban Rate")+
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept = 3.85179)
ggplotDfAlcAlconsumSuicide100 +
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/ 100 People")+
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept = 2.04562)
```
1.[ggplot] color line 

```{r}
ggplotDfAlcAlconsumEmplRt + 
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Employment Rate")+
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept= 4.84388,lty = 1, color = "red" )
ggplotDfAlcAlconsumUrbanRt +
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Urban Rate")+
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept = 3.85179,lty =2 , color = "red" )
ggplotDfAlcAlconsumSuicide100 +
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/ 100 People")+
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept = 2.04562,lty = 3, color = "red" )
```
>load library 

```{r}
library(dslabs)
```

1.[ggthemes] themes

```{r}
ggplotDfAlcAlconsumSuicide100 +
  ggthemes::theme_economist()+
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/ 100 People")+
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept = 2.04562,lty = 3, color = "red" )

ggplotDfAlcAlconsumSuicide100 +
  ggthemes::theme_fivethirtyeight()+
  geom_point(aes(col=region),size=0.6)+
  geom_text(nudge_x = 1 ,nudge_y = 0.5)+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/ 100 People")+
  ggtitle("World Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept = 2.04562,lty = 3, color = "red" )

```

1.[ggrepel] includes a geometry that adds labels ensuring that they don't fall on top of each other

```{r}
ggplotDfAlcAlconsumSuicide100 +
  ggthemes::theme_fivethirtyeight()+
  geom_point(aes(col=region),size=1)+
  ggrepel::geom_text_repel(
    nudge_x = .15,
    box.padding = 0.5,
    nudge_y = 1,
    segment.curvature = -0.1,
    segment.ncp = 3,
    segment.angle = 30,
    max.overlaps = 100) + 
    theme_bw() + 
    theme(legend.position = 'none')+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/ 100 People")+
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept = 2.04562,lty = 3, color = "red" )
```


1.[ggrepel] includes a geometry that adds labels ensuring that they don't fall on top of each other

```{r}
ggplotDfAlcAlconsumSuicide100 +
  ggthemes::theme_fivethirtyeight()+
  geom_point(aes(col=region,size = aconsum ))+
  ggrepel::geom_text_repel(
    nudge_x = .15,
    box.padding = 0.5,
    nudge_y = 1,
    segment.curvature = -0.1,
    segment.ncp = 3,
    segment.angle = 30,
    max.overlaps = 100) + 
  theme_bw() + 
  theme(legend.position = 'none')+
  ylab("Alcohol Consumption Rate")+
  xlab("Suicide/ 100 People")+
  ggtitle("EMEA Alcohol Consumption")+
  geom_abline(na.rm = TRUE, intercept = 2.04562,lty = 3, color = "red" )


```


1.[geomHistogrma] plot geom_histogram 

```{r}
dfAlcEMEA <- dfAlc %>%
filter(region == "EMEA") %>%
ggplot(aes(x = aconsum))
dfAlcEMEA + 
  geom_histogram()
```

1.[geomHistogrma] add bin width

```{r}
dfAlcEMEA + 
  geom_histogram(binwidth = 1)
```

1.[geomHistogrma] color

```{r}
dfAlcEMEA + 
  geom_histogram(binwidth = 1, fill = "cyan3", col = "cyan4") 
```

1.[geomHistogrma] add legend and title

```{r}
dfAlcEMEA + 
  geom_histogram(binwidth = 1, fill = "cyan3", col = "cyan4")+
  xlab("EMEA Alcohol Consumption")+
  ggtitle("Histogram")
 
```

1.[geomHistogrma] put together

```{r}
dfAlcEMEA <- dfAlc %>%
  filter(region == "EMEA") %>%
  ggplot(aes(x = aconsum))
dfAlcAPAC <- dfAlc %>%
  filter(region == "APAC") %>%
  ggplot(aes(x = aconsum))
histEMEA <- dfAlcEMEA + geom_histogram(binwidth = 1, fill = "aquamarine2", col = "aquamarine4")
histAPAC <- dfAlcAPAC + geom_histogram(binwidth = 1, fill = "aquamarine4", col = "aquamarine2")
gridExtra::grid.arrange(histEMEA, histAPAC, ncol = 2)
```

1.[geomDensity] plot geom_density 

```{r}
dfAlcEMEA + 
  geom_density()
```

1.[geomDensity] color

```{r}
dfAlcEMEA + 
  geom_density(fill = "bisque2", col = "bisque3") +
  xlab("EMEA Alcohol Consumption") +
  ggtitle("Density Plot")
```

1.[geomDensity] group by category 

```{r}
dfAlc %>%
  ggplot(aes(aconsum, group = region))+
  geom_density()
```

1.[geomDensity] color by category 

```{r}
dfAlc %>%
  ggplot(aes(aconsum, color = region))+
  geom_density()
```

1.[geomDensity] fill by category 

```{r}
dfAlc %>%
  ggplot(aes(aconsum, fill = region))+
  geom_density()
```

1.[geomDensity] alpha by category 

```{r}
dfAlc %>%
  ggplot(aes(aconsum, fill = region))+
  geom_density(alpha = 0.2)
```

1.[geomQQ] geom_qq plot

```{r}
dfAlcEMEA <- dfAlc %>%
filter(region == "EMEA") %>%
ggplot(aes(sample = aconsum))
dfAlcEMEA + 
  geom_qq(fill = "darkgoldenrod2", col = "darkgoldenrod3") +
  geom_qq_line(col = "darkgray") +
  xlab("EMEA Alcohol Consumption") +
  ggtitle("QQ Plot")
```

###### ^1^ Note: By default, the Q-Q plot is compared to the normal distribution with avrg = 0 and sd = 1
 
1.[geomQQ] geom_qq plot 

```{r}
params <- dfAlc %>%
  filter(region == "EMEA") %>%
  dplyr::summarize(mean = mean(aconsum), sd = sd(aconsum))
dfAlcEMEA +
  geom_qq(dparams = params, fill = "darkgoldenrod2", col = "darkgoldenrod3") +
  geom_qq_line(col = "darkgray") + 
  geom_abline(col = "brown3")+ #how well the normal approximation works #the points fall roughly on the line. This is because this data is approximately normal.
  xlab("EMEA Alcohol Consumption") +
  ggtitle("QQ Plot")
```

###### ^1^ Note: the Q-Q plot is compared against a normal distribution with same mean/sd as data

1.[geomQQ] geom_qq plot 

```{r}
dfAlc %>%
filter(region == "EMEA") %>%
  ggplot(aes(sample = scale(aconsum))) +
  geom_qq(fill = "darkgoldenrod2", col = "darkgoldenrod3") +
  geom_abline(col = "cornflowerblue")+
  xlab("EMEA Alcohol Consumption") +
  ggtitle("QQ Plot")
```

###### ^1^ Note: the Q-Q plot is compared against a standard normal distribution with same mean/sd as data

1.[dataFrame] filter

```{r}
gapminder %>%
  dplyr::filter(year == 2015 & country %in% c("Sri Lanka", "Turkey"))%>%
  dplyr::select(country, infant_mortality)
gapminder %>%
   dplyr::filter(year == 2015 & country %in% c("Malaysia", "Russia"))%>%
   dplyr::select(country,infant_mortality)
gapminder %>%
  dplyr:: filter(year == 2015 & country %in% c("Syria", "Turkey"))%>%
  dplyr:: select(country,infant_mortality)
```

1.[scatterPlot] ggplot

```{r}
ds_theme_set()    # set plot theme
filter(gapminder, year == 1962) %>%
  ggplot(aes(fertility, life_expectancy, color = continent)) +
  geom_point()
ds_theme_set()    # set plot theme
filter(gapminder, year == 2012) %>%
  ggplot(aes(fertility, life_expectancy, color = continent)) +
  geom_point()
```

1.[scatterPlot] ggplot, geom_point, facet_grid 2 variables

```{r}
filter(gapminder, year %in% c(1962, 2012)) %>% 
  ggplot(aes(fertility, life_expectancy, col = continent)) +
  geom_point() +
  facet_grid(continent ~ year)
```

1.[scatterPlot] ggplot, geom_point, facet_grid 1 variable

```{r}
filter(gapminder, year %in% c(1962, 2012)) %>% 
  ggplot(aes(fertility, life_expectancy, col = continent)) +
  geom_point() +
  facet_grid(. ~ year)
```

1.[scatterPlot] ggplot, geom_point, facet_grid 1 variable in motion 

```{r}
years <- c(1962, 1980, 1990, 2000, 2012)
continents <- c("Europe", "Asia")
gapminder %>%
  filter(year %in% years & continent %in% continents) %>%
  ggplot(aes(fertility, life_expectancy, col = continent)) +
  geom_point() +
  facet_wrap(~year)
```
1.[scatterPlot] ggplot, geom_point for time series 

```{r}
gapminder %>%
  filter(country == "Turkey") %>%
  ggplot(aes(year, fertility)) +
  geom_point(aes(colour = country))+
  xlim(1962,2012)+
  ylim(0,10)
gapminder %>%
  filter(country == "Sri Lanka") %>%
  ggplot(aes(year, fertility)) +
  geom_point(aes(colour = country))+
  xlim(1962,2012)+
  ylim(0,10)
gapminder %>%
  filter(country == "Syria") %>%
  ggplot(aes(year, fertility)) +
  geom_point(aes(colour = country))+
  xlim(1962,2012)+
  ylim(0,10)
```
1.[linePlot] ggplot, geom_line for time series 

```{r}
gapminder %>%
  filter(country == "Turkey") %>%
  ggplot(aes(year, fertility)) +
  geom_line(aes(colour = country))+
  xlim(1962,2012)+
  ylim(0,10)
gapminder %>%
  filter(country == "Sri Lanka") %>%
  ggplot(aes(year, fertility)) +
  geom_line(aes(colour = country))+
  xlim(1962,2012)+
  ylim(0,10)
gapminder %>%
  filter(country == "Syria") %>%
  ggplot(aes(year, fertility)) +
  geom_line(aes(colour = country))+
  xlim(1962,2012)+
  ylim(0,10)
```
1.[linePlot] ggplot, geom_line for multiple time series 

```{r}
gapminder %>% filter(country %in% c("Turkey","Sri Lanka","Syria")) %>%
  ggplot(aes(year, fertility, group = country)) +
  geom_line()+
  xlim(1962,2012)+
  ylim(0,10)
```

1.[linePlot] ggplot, geom_line for multiple time series color

```{r}
gapminder %>% filter(country %in% c("Turkey","Sri Lanka","Syria")) %>%
  ggplot(aes(year, fertility, col = country)) +
  geom_line()+
  xlim(1962,2012)+
  ylim(0,10)
```

1.[linePlot] ggplot, geom_line, geom_text for multiple time series color, label 

```{r}
countries <-  c("Turkey","Sri Lanka","Syria")
labels <- data.frame(country = countries, x = c(1964, 1965,1964), y = c(6.40,5.50,7.85))
gapminder %>% filter(country %in% c("Turkey","Sri Lanka","Syria")) %>%
  ggplot(aes(year, fertility, col = country)) +
  geom_line() +
  xlim(1962,2012)+
  ylim(0,10)+
  geom_text(data = labels, aes(x, y, label = country), size = 3) +
  theme(legend.position = "none")
```

1.[dataFrame] mutate

```{r}
gapminder <- gapminder %>%
  mutate(dollars_per_day = gdp/population/365)
```

1.[linePlot] ggplot, geom_histogram,color 

```{r}
year1962 <- 1962 
gapminder %>%
  filter(year == year1962 & !is.na(gdp)) %>%
  ggplot(aes(dollars_per_day)) +
  geom_histogram(binwidth = 1, fill = "lightgoldenrod1", color = "black")+
  xlim(0,150)+
  ylim(0,30)
year2011 <- 2011
gapminder %>%
  filter(year == year2011 & !is.na(gdp)) %>%
  ggplot(aes(dollars_per_day)) +
  geom_histogram(binwidth = 1, fill = "indianred1", color = "black") +
  xlim(0,150)+
  ylim(0,30)
```

1.[linePlot] ggplot, geom_histogram, log, color 

```{r}
year1962 <- 1962 
gapminder %>%
  filter(year == year1962 & !is.na(gdp)) %>%
  ggplot(aes(log2(dollars_per_day))) +
  geom_histogram(binwidth = 1, fill = "lightgoldenrod1", color = "black")+
  xlim(0,150)+
  ylim(0,30) 
year2011 <- 2011
gapminder %>%
  filter(year == year2011 & !is.na(gdp)) %>%
  ggplot(aes(log2(dollars_per_day))) +
  geom_histogram(binwidth = 1, fill = "indianred1", color = "black") +
  xlim(0,150)+
  ylim(0,30)
```
1.[linePlot] ggplot, geom_histogram, log, color 

```{r}
year1962 <- 1962 
gapminder %>%
  filter(year == year1962 & !is.na(gdp)) %>%
  ggplot(aes(dollars_per_day)) +
  geom_histogram(binwidth = 1, fill = "lightgoldenrod1", color = "black")+
  xlim(0,32)+
  ylim(0,30)+
  scale_x_continuous(trans = "log2")
year2011 <- 2011
gapminder %>%
  filter(year == year2011 & !is.na(gdp)) %>%
  ggplot(aes(log2(dollars_per_day))) +
  geom_histogram(binwidth = 1, fill = "indianred1", color = "black") +
  xlim(0,32)+
  ylim(0,30)+
  scale_x_continuous(trans = "log2")
```

1.[boxPlot] geom_boxplot, rotate labels through theme

```{r}
year1962 <- 1962 
gapminder %>%
  filter(year == year1962 & !is.na(gdp)) %>%
  ggplot(aes(region, dollars_per_day))+
  geom_boxplot()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
year2011 <- 2011 
gapminder %>%
  filter(year == year2011 & !is.na(gdp)) %>%
  ggplot(aes(region, dollars_per_day))+
  geom_boxplot()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

1.[column] stratify factor by level

```{r}
length(levels(gapminder$continent))
```

1.[column] check levels of a factor

```{r}
regionFac <- levels(gapminder$continent)
regionFac
```

1.[column] reorder factor's levels on a summary computed on a numeric vector

```{r}
value <- c(10, 11, 12, 6, 4)
facRegByValue <- reorder(regionFac, value, FUN = mean)
levels(facRegByValue)
```

1.[boxPlot] filter, mutate by reorder by median, ggplot, geom_boxplot, theme

```{r}
gapminder %>%
  filter(year == year1962 & !is.na(gdp)) %>%
  mutate(region = reorder(region, dollars_per_day, FUN = median)) %>%   
  ggplot(aes(region, dollars_per_day, fill = continent)) +    
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("")
gapminder %>%
  filter(year == year2011 & !is.na(gdp)) %>%
  mutate(region = reorder(region, dollars_per_day, FUN = median)) %>%   
  ggplot(aes(region, dollars_per_day, fill = continent)) +    
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("")
```
1.[boxPlot] filter, mutate by reorder by median, ggplot, geom_boxplot, theme, scale log2 

```{r}
gapminder %>%
  filter(year == year1962 & !is.na(gdp)) %>%
  mutate(region = reorder(region, dollars_per_day, FUN = median)) %>%   
  ggplot(aes(region, dollars_per_day, fill = continent)) +    
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("")+
  scale_y_continuous(trans = "log2")
gapminder %>%
  filter(year == year2011 & !is.na(gdp)) %>%
  mutate(region = reorder(region, dollars_per_day, FUN = median)) %>%   
  ggplot(aes(region, dollars_per_day, fill = continent)) +    
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("")+
  scale_y_continuous(trans = "log2")
```

1.[boxPlot] filter, mutate by reorder by median, ggplot, geom_boxplot, theme, scale log2, geom_point

```{r}
gapminder %>%
  filter(year == year1962 & !is.na(gdp)) %>%
  mutate(region = reorder(region, dollars_per_day, FUN = median)) %>%   
  ggplot(aes(region, dollars_per_day, fill = continent)) +    
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("")+
  scale_y_continuous(trans = "log2")+ 
  geom_point(show.legend = FALSE)
gapminder %>%
  filter(year == year2011 & !is.na(gdp)) %>%
  mutate(region = reorder(region, dollars_per_day, FUN = median)) %>%   
  ggplot(aes(region, dollars_per_day, fill = continent)) +    
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("")+
  scale_y_continuous(trans = "log2")+ 
  geom_point(show.legend = FALSE)
```
1.[vector] define

```{r}
west <- c("Western Europe", "Northern Europe", "Southern Europe", "Northern America", "Australia and New Zealand")
```

1.[histogram] filter, mutate by reorder by ifelse group, ggplot, geom_histogram,scale log2, facet grid

```{r}
gapminder %>%
  filter(year %in% c(year1962, year2011) & !is.na(gdp)) %>%
  mutate(group = ifelse(region %in% west, "West", "Developing")) %>%
  ggplot(aes(dollars_per_day)) +
  geom_histogram(binwidth = 1, color = "black") +
  scale_x_continuous(trans = "log2") +
  facet_grid(year ~ group)
```

1.[vectors] define filtering only with available data

```{r}
countryList1962 <- gapminder %>%
  filter(year == year1962 & !is.na(dollars_per_day)) %>% .$country
countryList2011 <- gapminder %>%
  filter(year == year2011 & !is.na(dollars_per_day)) %>% .$country
country19622011Intersect <- intersect(countryList1962, countryList2011)
```

1.[histogram] filter, mutate by reorder by ifelse group, ggplot, geom_histogram,scale log2, facet grid

```{r}
gapminder %>%
  filter(year %in% c(year1962, year2011) & country %in% country19622011Intersect) %>%    # keep only selected countries
  mutate(group = ifelse(region %in% west, "West", "Developing")) %>%
  ggplot(aes(dollars_per_day)) +
  geom_histogram(binwidth = 1, color = "black") +
  scale_x_continuous(trans = "log2") +
  facet_grid(year ~ group)
```

1.[boxplot] 

```{r}
gapminder %>%
  filter(year %in% c(year1962, year2011) & country %in% country19622011Intersect) %>%
  mutate(region = reorder(region, dollars_per_day, FUN = median)) %>%
  ggplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("") +
  scale_y_continuous(trans = "log2")+ 
  geom_boxplot(aes(region, dollars_per_day, fill = continent)) +
  facet_grid(year ~ .)
```

1.[boxplot] 

```{r}
gapminder %>%
  filter(year %in% c(year1962, year2011) & country %in% country19622011Intersect) %>%
  mutate(region = reorder(region, dollars_per_day, FUN = median)) %>%
  ggplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("") +
  scale_y_continuous(trans = "log2")+  
  geom_boxplot(aes(region, dollars_per_day, fill = factor(year)))
```

1.[densityPlot] smooth 

```{r}
gapminder %>%
  filter(year == year1962 & country %in% country19622011Intersect) %>%
  mutate(group = ifelse(region %in% west, "West", "Developing")) %>%
  ggplot(aes(dollars_per_day, y = ..count.., fill = group)) +
  scale_x_continuous(trans = "log2")+ 
  geom_density(alpha = 0.2, bw = 0.75) + # bw for smoothness 
  facet_grid(year ~ .)

```

###### ^1^ Note: To have the areas of the densities be proportional to the size of the groups,multiply the y-axis values by the size of the group

1.[case_when] add group as a factor

```{r}
gapminder<-gapminder %>%
  mutate(group = case_when(
    .$region %in% west ~ "West",
    .$region %in% c("Eastern Asia", "South-Eastern Asia") ~ "East Asia",
    .$region %in% c("Caribbean", "Central America", "South America") ~ "Latin America",
    .$continent == "Africa" & .$region != "Northern Africa" ~ "Sub-Saharan Africa",
    TRUE ~ "Others"))
gapminder %>%
  mutate(group = factor(group, levels = c("Others", "Latin America", "East Asia", "Sub-Saharan Africa", "West")))
```

1.[densityPlot] stacked

```{r}
gapminder %>%
  filter(year %in% c(year1962, year2011) & country %in% country19622011Intersect) %>%
  ggplot(aes(dollars_per_day, fill = group)) +
  scale_x_continuous(trans = "log2")+
  geom_density(alpha = 0.2, bw = 0.75, position = "stack") +
  facet_grid(year ~ .)
```

1.[densityPlot] weighted stacked

```{r}
gapminder %>%
  filter(year %in% c(year1962, year2011) & country %in% country19622011Intersect) %>%
  group_by(year) %>%
  mutate(weight = population/sum(population*2)) %>%
  ungroup() %>%
  ggplot(aes(dollars_per_day, fill = group, weight = weight)) +
  scale_x_continuous(trans = "log2") +
  geom_density(alpha = 0.2, bw = 0.75, position = "stack") + facet_grid(year ~ .)
```

###### ^1^ Note:  ecological fallacy = the almost perfect relationship between survival rates and income is only observed for the averages at the regional level

1.[case_when] add group as a factor

```{r}
gapminder <- gapminder %>%
  mutate(group = case_when(
    .$region %in% west ~ "The West",
    .$region %in% "Northern Africa" ~ "Northern Africa",
    .$region %in% c("Eastern Asia", "South-Eastern Asia") ~ "East Asia",
    .$region == "Southern Asia" ~ "Southern Asia",
    .$region %in% c("Central America", "South America", "Caribbean") ~ "Latin America",
    .$continent == "Africa" & .$region != "Northern Africa" ~ "Sub-Saharan Africa",
    .$region %in% c("Melanesia", "Micronesia", "Polynesia") ~ "Pacific Islands"))
```

1.[logitTransformation]

```{r}
surv_income <- gapminder %>%
  filter(year %in% year2011 & !is.na(gdp) & !is.na(infant_mortality) & !is.na(group)) %>%
  group_by(group) %>%
  summarise(income = sum(gdp)/sum(population)/365,
            infant_survival_rate = 1 - sum(infant_mortality/1000*population)/sum(population))
surv_income %>% arrange(income)
```

###### ^1^ Note: logit transformation = f of p equals the log of p divided by 1 minus p

1.[scatterPlot]

```{r}
surv_income %>% 
  ggplot(aes(income, infant_survival_rate, label = group, color = group)) +
  scale_x_continuous(trans = "log2", limit = c(0.25, 150)) +
  scale_y_continuous(trans = "logit", limit = c(0.875, .9981),
                     breaks = c(.85, .90, .95, .99, .995, .998)) +
  geom_label(size = 3, show.legend = FALSE)
```

1.[scatterPlot] aes

```{r}
gapminder %>% 
  filter( year == 2011,continent == 'Africa') %>%
  ggplot(aes(fertility, life_expectancy)) +
  geom_point()
```

1.[scatterPlot]  color category 

```{r}
gapminder %>% 
  filter(year ==2011 & continent == "Africa") %>%
  ggplot(aes(fertility, life_expectancy, color = region))+
  geom_point()
```

1.[dataFrame] conditioning 

```{r}
gapminder %>%
  dplyr::filter(year == 2011 & continent =="Africa" & fertility <=3 & life_expectancy >= 70)%>%
  dplyr::select(country,region)
```

1.[linePlot] time series  

```{r}
gapminder %>%
  filter(country %in% c("Vietnam","United States","Cambodia") & year>=1960 & year <=2010) %>%
  ggplot(aes(year, life_expectancy,color = country))+
  geom_line()
```

1.[linePlot] frequency 

```{r}
gapminder %>% 
  mutate(dollars_per_day = gdp/population/365)%>%
  filter(continent == "Africa", year == 2010,!is.na(gdp)) %>%
  ggplot(aes(dollars_per_day, y = ..count..))+
  geom_density()+
  scale_x_continuous(trans = "log2")
```

1.[densityPlot]

```{r}
gapminder %>%
  filter(continent == "Africa", year  %in% c(1970,2010),!is.na(gdp)) %>% mutate(dollars_per_day = gdp/population/365) %>%
  ggplot(aes(dollars_per_day, y =..count..)) +
  geom_density()+
  scale_x_continuous(trans="log2")+
  facet_grid(.~year)
```

1.[densityPlot] stack 

```{r}
gapminder %>%
  filter(continent == "Africa", year  %in% c(1970,2010),!is.na(gdp)) %>% 
  mutate(dollars_per_day = gdp/population/365) %>%
  ggplot(aes(dollars_per_day, y =..count.., fill = region)) +
  geom_density(bw = 0.5, position = "stack")+
  scale_x_continuous(trans="log2")+
  facet_grid(year~.)
```


1.[scatterPlot]

```{r}
gapminder %>%
  filter(continent == "Africa", year  == 2010,!is.na(gdp)) %>% 
  mutate(dollars_per_day = gdp/population/365)%>% 
  ggplot(aes(dollars_per_day,infant_mortality,color = region))+
  geom_point()
```

1.[scatterPlot] scale

```{r}
gapminder %>%
  filter(continent == "Africa", year  == 2010,!is.na(gdp)) %>% 
  mutate(dollars_per_day = gdp/population/365)%>% 
  ggplot(aes(dollars_per_day,infant_mortality,color = region))+
  geom_point()+ 
  scale_x_continuous(trans="log2")
```

1.[scatterPlot] label

```{r}
gapminder %>%
  filter(continent == "Africa", year  == 2010,!is.na(gdp)) %>% 
  mutate(dollars_per_day = gdp/population/365)%>% 
  ggplot(aes(dollars_per_day,infant_mortality,color = region, label = country))+
  geom_point()+ 
  scale_x_continuous(trans="log2")+
  geom_text()
```

1.[scatterPlot] facet

```{r}
gapminder %>%
  filter(continent == "Africa", year  %in% c(1970,2010),!is.na(gdp),!is.na(infant_mortality)) %>% 
  mutate(dollars_per_day = gdp/population/365) %>%
  ggplot(aes(dollars_per_day,infant_mortality, color = region, label = country)) +
  geom_point()+
  scale_x_continuous(trans="log2")+
  geom_text()+
  facet_grid(year~.)
```

1.[scatterPlot] jitter  - add a small random shift to each point 

```{r}
heights %>% 
  ggplot(aes(sex, height)) + 
  geom_jitter(width = 0.1, alpha = 0.2)+ 
  geom_boxplot(alpha= 0.5)
```

>load 

```{r}
library(dplyr)
library(ggplot2)
library(dslabs)
```

1.[vector] reorder

```{r}
usContDiseasesMeasles <- us_contagious_diseases %>%
  filter(year == 1967 & disease=="Measles" & 
           !is.na(population)) %>% 
  mutate(rate = count / population * 10000 * 52 / weeks_reporting)
state <- usContDiseasesMeasles$state 
rate <- usContDiseasesMeasles$count/(usContDiseasesMeasles$population/10000)*(52/usContDiseasesMeasles$weeks_reporting)
state <- reorder(state,rate, FUN = mean)
```

>load 

```{r}
library(dplyr)
library(ggplot2)
library(dslabs)
```

1.[barPlot] numeric order  

```{r}
data(us_contagious_diseases)
usContDiseasesMeasles <- us_contagious_diseases %>% 
  filter(year == 1967 & disease=="Measles" & count>0 & !is.na(population)) %>%
  mutate(rate = count / population * 10000 * 52 / weeks_reporting)
usContDiseasesMeasles %>% 
  mutate(state = reorder(state, rate, FUN = mean)) %>% 
  ggplot(aes(state, rate)) +
  geom_bar(stat="identity") +
  coord_flip()
#
```

1.[barPlot] numeric order

```{r}
gapminder %>%  
  filter(!is.na(fertility)) %>%
  mutate(region = reorder(region, fertility, FUN = median)) %>% 
  ggplot(aes(region, fertility)) +
  geom_bar(stat="identity") +
  coord_flip()
```

1.[boxplot] numeric order 

```{r}
murders %>% 
  mutate(rate = total/population*100000) %>%
  mutate(region = reorder(region, rate, FUN = median)) %>% 
  ggplot(aes(region,rate)) +
  geom_boxplot() + 
  geom_point()
```

>load 

```{r}
library(tidyverse)
library(dslabs) 
data(gapminder)
```

1.[slopePlot] 

```{r}
west <- c("Western Europe", "Northern Europe", "Southern Europe", "Northern America", "Australia and New Zealand")
gapminder20002015Slope <- gapminder %>%
  filter(year %in% c(2010, 2015) & region %in% west & !is.na(life_expectancy) & population > 10^7)
gapminder20002015Slope %>%
  mutate(location = ifelse(year == 2010, 1, 2),
         location = ifelse(year == 2015 & country %in% c("United Kingdom", "Portugal"),
                           location + 0.22, location),
         hjust = ifelse(year == 2010, 1, 0)) %>%
  mutate(year = as.factor(year)) %>%
  ggplot(aes(year, life_expectancy, group = country)) +
  geom_line(aes(color = country), show.legend = FALSE) +
  geom_text(aes(x = location, label = country, hjust = hjust), show.legend = FALSE) +
  xlab("") +
  ylab("Life Expectancy") 

```

>load 

```{r}
library(ggrepel)
```

1.[scatterPlot] Bland-Altman plot = Tukey Mean Difference plot

```{r}
west <- c("Western Europe", "Northern Europe", "Southern Europe", "Northern America", "Australia and New Zealand")
gapminder20002015Slope <- gapminder %>%
  filter(year %in% c(2010, 2015) & region %in% west & !is.na(life_expectancy) & population > 10^7)
gapminder20002015Slope %>%
  mutate(year = paste0("life_expectancy_", year)) %>%
  dplyr::select(country, year, life_expectancy) %>% spread(year, life_expectancy) %>%
  mutate(average = (life_expectancy_2015 + life_expectancy_2010)/2,
         difference = life_expectancy_2015 - life_expectancy_2010) %>%
  ggplot(aes(average, difference, label = country)) +
  geom_point() +
  geom_text_repel() +
  geom_abline(lty = 2) +
  xlab("Average of 2010 and 2015") +
  ylab("Difference between 2015 and 2010")
```

>load

```{r}
library(tidyverse)
library(dslabs)
```

1.[linePlot] intercept and time series  

```{r}
the_disease <- "Measles"
usContDisMeasles <- us_contagious_diseases %>%
  filter(!state %in% c("Hawaii", "Alaska") & disease == the_disease) %>%
  mutate(rate = count / population * 10000 * 52/weeks_reporting) %>%
  mutate(state = reorder(state, rate))
usContDisMeasles %>% 
  filter(state == "California" & !is.na(rate)) %>%
  ggplot(aes(year, rate)) +
  geom_line() +
  ylab("Cases per 10,000") +
  geom_vline(xintercept=1963, col = "blue") 
```
1.[tilePlot]  heat map

```{r}
usContDisMeasles %>% 
  ggplot(aes(year, state, fill=rate)) +
  geom_tile(color = "grey50") +
  scale_x_continuous(expand = c(0,0)) +
  scale_fill_gradientn(colors = RColorBrewer::brewer.pal(9, "Reds"), trans = "sqrt") +
  geom_vline(xintercept = 1963, col = "blue") +
  theme_minimal() + theme(panel.grid = element_blank()) +
  ggtitle(the_disease) +
  ylab("") +
  xlab("")
```

1.[linePlot]

```{r}
avg <- us_contagious_diseases %>%
  filter(disease == the_disease) %>% group_by(year) %>%
  summarise(us_rate = sum(count, na.rm = TRUE)/sum(population, na.rm = TRUE)*10000)
#  line plot of measles rate by year by state
usContDisMeasles %>%
  filter(!is.na(rate)) %>%
  ggplot() +
  geom_line(aes(year, rate, group = state), color = "grey50", 
            show.legend = FALSE, alpha = 0.2, size = 1) +
  geom_line(mapping = aes(year, us_rate), data = avg, size = 1, col = "black") +
  scale_y_continuous(trans = "sqrt", breaks = c(5, 25, 125, 300)) +
  ggtitle("Cases per 10,000 by state") +
  xlab("") +
  ylab("") +
  geom_text(data = data.frame(x = 1955, y = 50),
            mapping = aes(x, y, label = "US average"), color = "black") +
  geom_vline(xintercept = 1963, col = "blue")
```

>load

```{r}
library(dplyr)
library(ggplot2)
library(dslabs)
```

1.[tilePlot] heat map 

```{r}
the_disease = "Smallpox"
usContDiseasesSmallpox <- us_contagious_diseases %>% 
  filter(!state%in%c("Hawaii","Alaska") & disease == the_disease & weeks_reporting >= 10) %>% 
  mutate(rate = count / population * 10000) %>% 
  mutate(state = reorder(state, rate))
usContDiseasesSmallpox %>% 
  ggplot(aes(year, state, fill = rate)) + 
  geom_tile(color = "grey50") + 
  scale_x_continuous(expand=c(0,0)) + 
  scale_fill_gradientn(colors = brewer.pal(9, "Reds"), trans = "sqrt") + 
  theme_minimal() + 
  theme(panel.grid = element_blank()) + 
  ggtitle(the_disease) + 
  ylab("") + 
  xlab("")
```

1.[linePlot]

```{r}
the_disease = "Smallpox"
usContDiseasesSmallpox <- us_contagious_diseases %>%
  filter(!state%in%c("Hawaii","Alaska") & disease == the_disease & weeks_reporting >= 10) %>%
  mutate(rate = count / population * 10000) %>%
  mutate(state = reorder(state, rate))
avg <- us_contagious_diseases %>%
  filter(disease==the_disease & weeks_reporting >= 10) %>% group_by(year) %>%
  summarise(us_rate = sum(count, na.rm=TRUE)/sum(population, na.rm=TRUE)*10000)
usContDiseasesSmallpox %>% 
  ggplot() +
  geom_line(aes(year, rate, group = state),  color = "grey50", 
            show.legend = FALSE, alpha = 0.2, size = 1) +
  geom_line(mapping = aes(year, us_rate),  data = avg, size = 1, color = "black") +
  scale_y_continuous(trans = "sqrt", breaks = c(5,25,125,300)) + 
  ggtitle("Cases per 10,000 by state") + 
  xlab("") + 
  ylab("") +
  geom_text(data = data.frame(x=1955, y=50), mapping = aes(x, y, label="US average"), color="black") + 
  geom_vline(xintercept=1963, col = "blue")

```

>load

```{r}
library(dplyr)
library(ggplot2)
library(dslabs)
library(RColorBrewer)
```

1.[linePlot] 

```{r}
data(us_contagious_diseases)
us_contagious_diseases %>% 
  filter(state=="California"  & weeks_reporting >= 10) %>% 
  group_by(year, disease) %>%
  summarise(rate = sum(count)/sum(population)*10000) %>%
  ggplot(aes(year, rate,color = disease)) + 
  geom_line()
```
1.[linePlot]

```{r}
us_contagious_diseases %>%
  filter(!is.na(population)) %>%
  group_by(year, disease) %>%
  summarise(rate = sum(count)/sum(population)*10000) %>%
  ggplot(aes(year, rate, color = disease)) +
  geom_line()
```
>load 

```{r}
library(tidyverse)
library(titanic)
```

1.[length] reduce digits' number 

```{r}
options(digits = 3)  
```

1.[dataFrame] select mutate 

```{r}
titanic <- titanic_train %>%
  dplyr::select(Survived, Pclass, Sex, Age, SibSp, Parch, Fare) %>%
  mutate(Survived = factor(Survived),
         Pclass = factor(Pclass),
         Sex = factor(Sex))
```

1.[densityPlot] facet

```{r}
titanic %>%
  ggplot(aes(Age, fill = Sex)) +
  geom_density(alpha = 0.2) +
  facet_grid(Sex ~ .)
```
1.[densityPlot] without facet 

```{r}
titanic %>%
  ggplot(aes(Age, fill = Sex)) +
  geom_density(alpha = 0.2)
```
1.[frequencyPlot]

```{r}
titanic %>%
  ggplot(aes(Age, y = ..count.., fill = Sex)) +
  geom_density(alpha = 0.2, position = "stack")
```

1.[QQPlot] 

```{r}
params <- titanic %>%
  filter(!is.na(Age)) %>%
  summarise(mean = mean(Age), sd = sd(Age))
titanic %>%
  ggplot(aes(sample = Age)) +
  geom_qq(dparams = params) +
  geom_abline()
```

1.[barPlot] 

```{r}
titanic %>%
  ggplot(aes(Survived, fill = Sex)) +
  geom_bar()
```
1.[barPlot] position_dodge

```{r}
titanic %>%
  ggplot(aes(Survived, fill = Sex)) +
  geom_bar(position = position_dodge())
```

1.[barPlot]

```{r}
titanic %>%
  ggplot(aes(Sex, fill = Survived)) +
  geom_bar()
```

1.[densityPlot]

```{r}
titanic %>%
  ggplot(aes(Age, y = ..count.., fill = Survived)) +
  geom_density(alpha = 0.2)
```
1.[boxplot] geom_jitter

```{r}
titanic %>%
  filter(Fare != 0)%>%
  ggplot(aes(Survived,Fare)) +
  geom_boxplot(alpha = 0.2) +
  scale_y_continuous(trans = "log2")+
  geom_jitter()
```

1.[barPlot]

```{r}
titanic %>%
  ggplot(aes(Pclass, fill = Survived))+
  geom_bar()
```
1.[barPlot] show relative proportions in each group instead of counts

```{r}
titanic %>%
  ggplot(aes(Pclass, fill = Survived))+
  geom_bar(position = position_fill())
```

1.[barPlot]

```{r}
titanic %>%
  ggplot(aes(Survived, fill = Pclass))+
  geom_bar(position = position_fill())
```

1.[desnityPlot] grid 

```{r}
titanic %>%
  ggplot(aes(Age, fill = Survived, y = ..count..)) +
  geom_density(alpha = 0.2) +
  facet_grid(Pclass~ Sex) 
```
>load

```{r}
library(tidyverse)
library(dslabs)
data(stars)
```

1.[digits] reduce number

```{r}
options(digits = 3)
```

1.[numbers] mean and sd

```{r}
mean(stars$magnitude)
sd(stars$magnitude)
```

1.[desnityPlot]

```{r}
stars %>%
  ggplot(aes(magnitude)) +
  geom_density(alpha = 0.2) 
```

1.[histogram] 

```{r}
stars %>% 
  ggplot(aes(temp)) +
  geom_histogram()
```
1.[scatterPlot]

```{r}
stars %>% 
  ggplot(aes(temp, magnitude)) +
  geom_point() #decreasing exponential
```

1.[logTransform]
 
```{r}
stars %>% 
  ggplot(aes(temp, magnitude)) +
  scale_y_reverse()+
  scale_x_continuous(trans = "log10")+
  scale_x_reverse()+
  geom_point()
```
1.[estimation] estimation of average 

```{r}
estimateGigants<- stars%>%
  filter(temp <10000)
mean(estimateGigants$temp)
```

1.[scatterPlot] geom_label 

```{r}
# label
stars %>% 
  ggplot(aes(temp, magnitude,label = star)) +
  scale_y_reverse()+
  scale_x_continuous(trans = "log10")+
  scale_x_reverse()+
  geom_label(size = 3, show.legend = TRUE) 
```

1.[scatterPlot] color point 

```{r}

head(stars)
stars %>%  
  ggplot(aes(temp, magnitude, color = type)) +
  scale_y_reverse()+
  scale_x_continuous(trans = "log10")+
  scale_x_reverse()+
  geom_point()
```

>load

```{r}
library(tidyverse)
library(dslabs)
data(temp_carbon)
data(greenhouse_gases)
data(historic_co2)
head(temp_carbon)
```
1.[vector] pull max 

```{r}
temp_carbon %>%
  dplyr::filter(!is.na(carbon_emissions)) %>%
  dplyr:: pull(year) %>%
  max()
#
temp_carbon %>%
  dplyr::filter(!is.na(carbon_emissions)) %>%
  .$year %>%
  max()
#
temp_carbon %>%
  dplyr::filter(!is.na(carbon_emissions)) %>%
  dplyr::select(year) %>%
  max()
#
temp_carbon %>%
  dplyr::filter(!is.na(temp_anomaly)) %>%
  dplyr::pull(year) %>%
  max()
```

1.[vector] pull min 

```{r}
temp_carbon %>%
  dplyr::filter(!is.na(carbon_emissions)) %>%
  dplyr::pull(year) %>%
  min()
temp_carbon %>%
  dplyr::filter(!is.na(temp_anomaly)) %>%
  dplyr::pull(year) %>%
  min()
```

1.[vector] proportion 

```{r}
lastYear <- temp_carbon %>%
  filter(year == 2014)
firstYear <- temp_carbon %>%
  filter(year == 1751)
proportion<- lastYear$carbon_emissions/firstYear$carbon_emissions

```

1.[vector] difference

```{r}
lastYear <- temp_carbon %>%
  filter(year == 2018)
firstYear <- temp_carbon %>%
  filter(year == 1880)
difference<- lastYear$temp_anomaly - firstYear$temp_anomaly
```

1.[vector] mean across interval 

```{r}
twCentury <- temp_carbon %>%
  filter(!is.na(temp_anomaly) & year %in% c(1901:2000))
```

1.[linePlot] 

```{r}
twCentury %>%
  ggplot(aes(year,temp_anomaly)) +
  geom_line() +
  geom_hline(yintercept = 0, col="blue") +
  ylab("t anomaly in C degrees") +
  ggtitle("t anomaly relative to 20th century mean, 1880-2018") +
  geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue") +
  geom_vline(aes(xintercept=1939),col="red") +
  geom_vline(aes(xintercept=1976),col="green") +
  geom_text(aes(x=1936,y=0.05,label="1939"),col="red") +
  geom_text(aes(x=1978,y=0.05,label="1976"),col="green")
```

1.[linePlot]

```{r}
  temp_carbon%>%
    filter(year %in% c(1880:2020)) %>%
    filter(!is.na(temp_anomaly)) %>%
    filter(!is.na(ocean_anomaly))%>%
    filter(!is.na(land_anomaly))%>%
    ggplot() +
    geom_line(aes(x = year,y=temp_anomaly), col = "black")+
    geom_line(aes(x = year,y=ocean_anomaly), col = "blue")+
    geom_line(aes(x = year,y=land_anomaly), col = "green")+ 
    ylab("anomaly")+
    geom_hline(yintercept = 0, col="black",alpha=0.5) +
    geom_vline(xintercept = 2018, col="black",alpha=0.5)
```

1.[linePlot]

```{r}
greenhouse_gases %>%
  ggplot(aes(x= year,y = concentration)) +
  geom_line() +
  facet_grid(gas ~., scales = "free") +
  geom_vline(xintercept = 1850)+ #Add a vertical line with an x-intercept at the year 1850, noting the unofficial start of the industrial revolution and widespread fossil fuel consumption
  ylab("Concentration (ch4/n2o ppb, co2 ppm)") +
  ggtitle("Atmospheric greenhouse gas concentration by year, 0-2000")
```

1.[linePlot] time series 

```{r}
temp_carbon%>%
  filter(!is.na(carbon_emissions)) %>%
  ggplot() +
  geom_line(aes(x = year,y=carbon_emissions), col = "black")+
  ylab("carbon emissions")
```
1.[linePlot]

```{r}
historic_co2 %>%
  ggplot(aes(year,co2,color = source))+
  geom_line()
```

1.[linePlot]

```{r}
historic_co2 %>%
    filter(year>1500) %>%
    ggplot(aes(year,co2,color=source)) +
    geom_line()
```

1.{linePlot}

```{r}
historic_co2 %>%
  ggplot(aes(year,co2,color=source)) +
  geom_line() +
  xlim(-800000,-775000)
historic_co2 %>%
    ggplot(aes(year,co2,color=source)) +
    geom_line() +
    xlim(-375000 ,-330000)
historic_co2 %>%
  ggplot(aes(year,co2,color=source)) +
  geom_line() +
  xlim(-140000 ,-120000)
historic_co2 %>%
    ggplot(aes(year,co2,color=source)) +
    geom_line() +
    xlim(1700,2018)
```


## References

